<!DOCTYPE html><html lang="en" amp=""><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><link rel="icon" href="/images/icon.png"><meta name="theme-color" content="#3b4252"><title>The Sorting Hat Experiment | WebAR in pure JS - Miki Lombardi</title><link rel="preconnect" href="https://fonts.gstatic.com"><link href="https://fonts.googleapis.com/css2?family=Red+Hat+Display&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tailwindcss/typography@0.2.x/dist/typography.min.css"><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script><link href="/css/about.1312b8c5.css" rel="prefetch"><link href="/js/about.675f5ff8.js" rel="prefetch"><link href="/js/chunk-2d0cf6d6.e6f6d766.js" rel="prefetch"><link href="/js/chunk-2d0d6391.331694ff.js" rel="prefetch"><link href="/js/chunk-2d0d69b1.3c6cac3b.js" rel="prefetch"><link href="/js/chunk-2d0de2f3.2b4689c6.js" rel="prefetch"><link href="/js/chunk-2d0de79d.4d1d5af4.js" rel="prefetch"><link href="/js/chunk-2d0e4833.40004825.js" rel="prefetch"><link href="/js/chunk-2d0e599e.ac24a02d.js" rel="prefetch"><link href="/js/chunk-2d208114.3f138e4b.js" rel="prefetch"><link href="/js/chunk-2d2109de.141ca7ff.js" rel="prefetch"><link href="/js/chunk-2d213737.8cb5b0c4.js" rel="prefetch"><link href="/js/chunk-2d21d51b.9549b08e.js" rel="prefetch"><link href="/js/chunk-2d21eace.bb4c5b26.js" rel="prefetch"><link href="/js/chunk-2d221839.3fed34d2.js" rel="prefetch"><link href="/js/chunk-2d2248e4.2df9a3a6.js" rel="prefetch"><link href="/js/chunk-2d230282.de43d66e.js" rel="prefetch"><link href="/js/chunk-2d230644.a842f60a.js" rel="prefetch"><link href="/css/app.755b211d.css" rel="preload" as="style"><link href="/js/app.c1e52978.js" rel="preload" as="script"><link href="/js/chunk-vendors.f00deeb5.js" rel="preload" as="script"><link href="/css/app.755b211d.css" rel="stylesheet"><link href="https://www.googletagmanager.com" rel="preconnect"><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-98330359-1&amp;l=dataLayer" charset="utf-8"></script><script charset="utf-8" src="/js/chunk-2d230644.a842f60a.js"></script><meta data-vue-meta="1" data-vmid="description" name="description" content="The power of AR in the palm of a hand Google, with Chrome, is trying to develop and guarantee support for AR and VR by proposing a standard at the level of W3C. The proposals are still in draft and in the proposal phase, but there are already some experiments that can be tried."><meta data-vue-meta="1" data-vmid="og:title" name="og:title" content="The Sorting Hat Experiment | WebAR in pure JS"><meta data-vue-meta="1" data-vmid="og:type" name="og:type" content="article"><meta data-vue-meta="1" data-vmid="og:url" name="og:url" content="http://localhost:8000/blog/2020-02-23-sorting-hat-experiment-webar-in-js"><meta data-vue-meta="1" data-vmid="og:site_name" name="og:site_name" content="localhost"><meta data-vue-meta="1" data-vmid="og:description" name="og:description" content="The power of AR in the palm of a hand Google, with Chrome, is trying to develop and guarantee support for AR and VR by proposing a standard at the level of W3C. The proposals are still in draft and in the proposal phase, but there are already some experiments that can be tried."><meta data-vue-meta="1" data-vmid="og:image" name="og:image" content="https://source.unsplash.com/Qqsgit1tyWw/960x680"><meta data-vue-meta="1" data-vmid="twitter:widgets:csp" name="twitter:widgets:csp" content="on"><meta data-vue-meta="1" data-vmid="twitter:card" name="twitter:card" content="https://source.unsplash.com/Qqsgit1tyWw/960x680"><meta data-vue-meta="1" data-vmid="twitter:image" name="twitter:image" content="https://source.unsplash.com/Qqsgit1tyWw/960x680"><meta data-vue-meta="1" data-vmid="twitter:site" name="twitter:site" content="@thejoin95"><meta data-vue-meta="1" data-vmid="twitter:creator" name="twitter:creator" content="@thejoin95"><meta data-vue-meta="1" data-vmid="twitter:domain" name="twitter:domain" content="localhost"><meta data-vue-meta="1" data-vmid="twitter:title" name="twitter:title" content="The Sorting Hat Experiment | WebAR in pure JS"><meta data-vue-meta="1" data-vmid="twitter:description" name="twitter:description" content="The power of AR in the palm of a hand Google, with Chrome, is trying to develop and guarantee support for AR and VR by proposing a standard at the level of W3C. The proposals are still in draft and in the proposal phase, but there are already some experiments that can be tried."><script data-vue-meta="1" type="application/ld+json">{"@context":"https://schema.org","@type":"TechArticle","author":"Miki Lombardi","name":"The Sorting Hat Experiment | WebAR in pure JS","articleBody":" <h1 id=\"the-sorting-hat-experiment--webar-in-pure-js\">The Sorting Hat Experiment | WebAR in pure JS</h1> <div class=\"mx-auto\"> <img class=\"max-w-full\" src=\"https://source.unsplash.com/Qqsgit1tyWw/960x680\"/> </div> <p>The power of <a href=\"https://arvrjourney.com/\">augmented reality</a> in the palm of a hand: Google, with Chrome, is trying to develop and guarantee support for AR and VR by proposing a standard at the level of W3C. The proposals are still in draft and in the proposal phase, but there are already some experiments that can be tried.</p> <h2 id=\"how-to-implement-an-experience-in-ar\">How to implement an experience in AR</h2> <p>There are many applications and experiments with AR technology, while there are few experiments with the same technology directly on the web.</p> <p>Despite the investments of many Big Companies on this technology, there is still no real standard for their realization.</p> <p>For the native, there are various libraries, tools and frameworks. Google has developed ARCore, which can be implemented on both iOS and Android, while Apple has developed ArKit which however can only be released on iOS.</p> <p>If we stop to reflect, the current lingua franca is javascript. The current environment, which everyone has, is the web. It is true, there is no guarantee of performance, due to the large scale of devices that have access to it.</p> <p>However, we can still achieve excellent results.</p> <h2 id=\"the-webgl-experiment\">The WebGL experiment</h2> <p><img src=\"https://cdn-images-1.medium.com/max/2000/1*M3a3KWEdil5yJxxSkhxssA.png\" alt=\"\"></p> <p>About two years ago I implemented a small experiment in WebGL to extend the reality and, in fact, carry out an AR experiment: to implement the talking hat of the famous Harry Potter saga, to sort the various users in the various Hogwarts houses.</p> <p>You can see the full project by clicking on the <a href=\"https://github.com/TheJoin95/sorting-hat-experiment-webgl\">Sorting Hat Experiment</a> repo link.</p> <p>The result can be visited <a href=\"https://experiments.thejoin.tech/\">here</a> (self- signed certificate).</p> <h2 id=\"technologies-used-for-the-experiment\">Technologies used for the experiment</h2> <p>The experiment was implemented in pure javascript, using the <a href=\"https://threejs.org/\">Three.js</a> library , the native API to retrieve the camera and accelerometer input and making use of the <a href=\"https://trackingjs.com/\">https://trackingjs.com/</a> library for facial recognition (via a MobileNet ).</p> <p>At the time of the experiment, there was still no google project to implement the WebXR API (API to implement the native web AR) in Chrome, nor the version of Three.js, oriented towards the management of a 3D environment in <a href=\"https://arvrjourney.com/\">VR</a>, AR-oriented: <a href=\"https://github.com/google-ar/three.ar.js\">Three.ar.js</a> .</p> <h2 id=\"how-the-experiment-was-implemented\">How the experiment was implemented</h2> <p>The implementation was simple, as the only inputs are the camera of the device (pc or smartphone) and the input of the questionnaire taken from the Pottermore site (a reference site for the Harry Potter saga).</p> <p>The critical issues are related to the support of a wide range of devices. The experiment, not using libraries optimized for <a href=\"https://arvrjourney.com/\">AR</a>, suffers from *fps lag, *on older devices with CPU and GPU not of medium / high range.</p> <p><img src=\"https://cdn-images-1.medium.com/max/2000/1*ThaRgxpoSZyj58F-f20Iww.png\" alt=\"Example of face recognition in web app\"><em>Example of face recognition in web app</em></p> <p>The greatest optimization, to try to solve this problem, was done in rendering the 3D model of the sorting hat based on facial recognition.</p> <p>This process brings a big charge at the CPU and GPU level, since on each tick he has to update the whole canvas (our AR level) and reposition the hat.</p> <p>The main optimization was to carry out the facial reconnaissance process only every tot of frames per second, in this way it is possible to guarantee a smooth experience without weighing down the less performing device, effectively levelling all the other higher-end devices. .</p> <p>At the start of the quiz, audio files were loaded and played in sequence, based on the choices of the questionnaire, which replicated the scenes of the film and the indecision of the hat.</p> <p>At the end of the quiz, the sorting hat decreed the house of belonging and exclaimed its name.</p> <h2 id=\"conclusion\">Conclusion</h2> <p>An experiment of this kind, brought to a more professional level, with the right tools and with more resources, could certainly be useful to JK Rowling in the boom of the saga to further retain the various users.</p> ","abstract":"The power of AR in the palm of a hand Google, with Chrome, is trying to develop and guarantee support for AR and VR by proposing a standard at the level of W3C. The proposals are still in draft and in the proposal phase, but there are already some experiments that can be tried."}</script></head><body><noscript><strong>We're sorry but portfolio doesn't work properly without JavaScript enabled. Please enable it to continue.</strong></noscript><div id="app"><div class="lettering content fixed" style="opacity: -1; display: none;"><div class="slideshow"><div class="slide slide--current"><svg class="shapes" width="800px" height="600px" viewbox="0 0 800 600"><rect width="18.253515625" height="16.74" x="256.8185546875" y="282.63" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(42px) translateY(-109px) scale(0.33) rotate(-7deg);"></rect><rect width="14.031015625" height="9.287999999999998" x="258.9298046875" y="286.356" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(5px) translateY(137px) scale(0.2) rotate(-8deg);"></rect><rect width="6.377734374999999" height="35.532000000000004" x="262.7564453125" y="273.234" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(67px) translateY(-57px) scale(0.33) rotate(-6deg);"></rect><circle r="21.9921875" cx="265.9453125" cy="291" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(-79px) translateY(-30px) scale(0.44) rotate(-6deg);"></circle><circle r="21.9921875" cx="265.9453125" cy="291" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(75px) translateY(191px) scale(0.5) rotate(-9deg);"></circle><rect width="12.403593749999999" height="26.784" x="259.743515625" y="277.608" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(56px) translateY(183px) scale(0.44) rotate(15deg);"></rect><circle r="21.9921875" cx="265.9453125" cy="291" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(152px) translateY(59px) scale(0.24) rotate(7deg);"></circle><polygon points="243.953125 345, 265.9453125 301.015625, 287.9375 345" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(-111px) translateY(-169px) scale(0.53) rotate(-16deg);"></polygon><rect width="20.936562499999997" height="11.664" x="255.47703125" y="285.168" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(-29px) translateY(40px) scale(0.29) rotate(-1deg);"></rect><circle r="21.9921875" cx="265.9453125" cy="291" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 265.945px 291px; transform: translateX(-71px) translateY(149px) scale(0.58) rotate(11deg);"></circle><rect width="18.304" height="48.492000000000004" x="304.7855" y="266.754" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(-58px) translateY(-143px) scale(0.57) rotate(-6deg);"></rect><polygon points="287.9375 345, 313.9375 293, 339.9375 345" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(29px) translateY(-154px) scale(0.4) rotate(-8deg);"></polygon><rect width="23.66" height="33.804" x="302.1075" y="274.098" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(-90px) translateY(49px) scale(0.58) rotate(-1deg);"></rect><rect width="8.632" height="8.424" x="309.6215" y="286.788" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(199px) translateY(-110px) scale(0.21) rotate(5deg);"></rect><rect width="20.228" height="12.528" x="303.8235" y="284.736" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(-123px) translateY(-175px) scale(0.53) rotate(-11deg);"></rect><rect width="7.8" height="20.52" x="310.0375" y="280.74" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(-104px) translateY(45px) scale(0.23) rotate(1deg);"></rect><rect width="23.66" height="20.088" x="302.1075" y="280.956" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(-51px) translateY(181px) scale(0.55) rotate(5deg);"></rect><polygon points="287.9375 345, 313.9375 293, 339.9375 345" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(-93px) translateY(-190px) scale(0.23) rotate(-5deg);"></polygon><rect width="3.224" height="15.552" x="312.3255" y="283.224" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(-140px) translateY(15px) scale(0.48) rotate(-15deg);"></rect><rect width="12.896" height="23.868" x="307.4895" y="279.06600000000003" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 313.938px 291px; transform: translateX(-30px) translateY(138px) scale(0.57) rotate(-2deg);"></rect><rect width="3.5543125" height="15.876" x="362.17596875" y="283.062" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(-169px) translateY(-34px) scale(0.47) rotate(-5deg);"></rect><polygon points="339.9375 345, 363.953125 296.96875, 387.96875 345" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(-78px) translateY(-65px) scale(0.48) rotate(12deg);"></polygon><rect width="3.50628125" height="5.94" x="362.199984375" y="288.03" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(103px) translateY(100px) scale(0.55) rotate(15deg);"></rect><polygon points="339.9375 345, 363.953125 296.96875, 387.96875 345" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(-49px) translateY(68px) scale(0.5) rotate(8deg);"></polygon><rect width="7.73303125" height="31.535999999999998" x="360.086609375" y="275.23199999999997" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(71px) translateY(167px) scale(0.57) rotate(13deg);"></rect><circle r="24.015625" cx="363.953125" cy="291" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(-92px) translateY(-73px) scale(0.25) rotate(-9deg);"></circle><rect width="16.234562500000003" height="8.316" x="355.83584375" y="286.842" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(155px) translateY(73px) scale(0.5) rotate(-13deg);"></rect><rect width="3.266125" height="32.616" x="362.3200625" y="274.692" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(100px) translateY(-27px) scale(0.55) rotate(12deg);"></rect><rect width="14.6975625" height="25.272000000000002" x="356.60434375" y="278.364" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(162px) translateY(-151px) scale(0.59) rotate(-13deg);"></rect><rect width="17.099125" height="53.46" x="355.4035625" y="264.27" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 363.953px 291px; transform: translateX(180px) translateY(-168px) scale(0.43) rotate(16deg);"></rect><rect width="9.21078125" height="19.439999999999998" x="403.386796875" y="281.28" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(-59px) translateY(52px) scale(0.41) rotate(10deg);"></rect><polygon points="387.96875 345, 407.9921875 304.953125, 428.015625 345" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(139px) translateY(-39px) scale(0.32) rotate(-5deg);"></polygon><circle r="20.0234375" cx="407.9921875" cy="291" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(-106px) translateY(-148px) scale(0.58) rotate(-2deg);"></circle><rect width="7.168390625" height="32.616" x="404.4079921875" y="274.692" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(100px) translateY(-52px) scale(0.45) rotate(15deg);"></rect><polygon points="387.96875 345, 407.9921875 304.953125, 428.015625 345" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(153px) translateY(-46px) scale(0.28) rotate(-16deg);"></polygon><rect width="16.579406249999998" height="50.220000000000006" x="399.702484375" y="265.89" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(-187px) translateY(-18px) scale(0.45) rotate(16deg);"></rect><rect width="14.416875" height="47.088" x="400.78375" y="267.456" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(-133px) translateY(114px) scale(0.34) rotate(11deg);"></rect><rect width="4.08478125" height="10.044" x="405.949796875" y="285.978" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(-71px) translateY(23px) scale(0.58) rotate(-8deg);"></rect><polygon points="387.96875 345, 407.9921875 304.953125, 428.015625 345" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(149px) translateY(184px) scale(0.58) rotate(6deg);"></polygon><circle r="20.0234375" cx="407.9921875" cy="291" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 407.992px 291px; transform: translateX(-51px) translateY(97px) scale(0.33) rotate(-9deg);"></circle><rect width="8.234296875" height="30.996" x="451.9062890625" y="275.502" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(-96px) translateY(72px) scale(0.41) rotate(14deg);"></rect><polygon points="428.015625 345, 456.0234375 288.984375, 484.03125 345" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(-41px) translateY(121px) scale(0.43) rotate(-3deg);"></polygon><rect width="22.014140625" height="37.044000000000004" x="445.0163671875" y="272.478" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(128px) translateY(197px) scale(0.36) rotate(-5deg);"></rect><rect width="8.06625" height="41.688" x="451.9903125" y="270.156" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(1px) translateY(130px) scale(0.41) rotate(-16deg);"></rect><rect width="22.294218750000002" height="41.904" x="444.876328125" y="270.048" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(-144px) translateY(-55px) scale(0.39) rotate(9deg);"></rect><rect width="26.327343749999997" height="9.395999999999999" x="442.859765625" y="286.302" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(194px) translateY(-151px) scale(0.26) rotate(-15deg);"></rect><polygon points="428.015625 345, 456.0234375 288.984375, 484.03125 345" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(-148px) translateY(-119px) scale(0.22) rotate(-10deg);"></polygon><rect width="10.250859375" height="44.82" x="450.8980078125" y="268.59" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(123px) translateY(83px) scale(0.34) rotate(-15deg);"></rect><circle r="28.0078125" cx="456.0234375" cy="291" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(-27px) translateY(-119px) scale(0.57) rotate(2deg);"></circle><rect width="4.425234375" height="22.032" x="453.8108203125" y="279.984" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 456.023px 291px; transform: translateX(-110px) translateY(27px) scale(0.4) rotate(9deg);"></rect><circle r="10.0078125" cx="494.0390625" cy="291" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(160px) translateY(110px) scale(0.38) rotate(-4deg);"></circle><rect width="3.542765625" height="35.856" x="492.2676796875" y="273.072" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(114px) translateY(141px) scale(0.4) rotate(5deg);"></rect><rect width="3.182484375" height="17.82" x="492.44782031249997" y="282.09000000000003" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(65px) translateY(-17px) scale(0.25) rotate(1deg);"></rect><rect width="3.943078125" height="25.38" x="492.0675234375" y="278.31" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(-50px) translateY(-55px) scale(0.57) rotate(-9deg);"></rect><polygon points="484.03125 345, 494.0390625 324.984375, 504.046875 345" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(-143px) translateY(-56px) scale(0.24) rotate(16deg);"></polygon><rect width="4.063171875" height="46.116" x="492.0074765625" y="267.942" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(109px) translateY(151px) scale(0.38) rotate(10deg);"></rect><circle r="10.0078125" cx="494.0390625" cy="291" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(2px) translateY(144px) scale(0.58) rotate(-5deg);"></circle><circle r="10.0078125" cx="494.0390625" cy="291" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(-116px) translateY(198px) scale(0.56) rotate(-11deg);"></circle><rect width="1.0207968749999998" height="8.964" x="493.5286640625" y="286.51800000000003" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(137px) translateY(29px) scale(0.32) rotate(1deg);"></rect><polygon points="484.03125 345, 494.0390625 324.984375, 504.046875 345" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 494.039px 291px; transform: translateX(142px) translateY(70px) scale(0.35) rotate(-2deg);"></polygon><rect width="5.096" height="52.379999999999995" x="527.498875" y="264.81" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(-114px) translateY(112px) scale(0.53) rotate(10deg);"></rect><rect width="17.991999999999997" height="40.608" x="521.050875" y="270.696" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(-194px) translateY(62px) scale(0.29) rotate(-4deg);"></rect><rect width="23.972" height="23.436" x="518.060875" y="279.282" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(119px) translateY(149px) scale(0.27) rotate(-2deg);"></rect><circle r="26" cx="530.046875" cy="291" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(-145px) translateY(-110px) scale(0.42) rotate(-4deg);"></circle><polygon points="504.046875 345, 530.046875 293, 556.046875 345" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(-197px) translateY(146px) scale(0.43) rotate(5deg);"></polygon><rect width="11.232" height="7.452000000000001" x="524.430875" y="287.274" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(78px) translateY(-60px) scale(0.53) rotate(-10deg);"></rect><rect width="12.116000000000001" height="43.308" x="523.988875" y="269.346" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(-167px) translateY(194px) scale(0.4) rotate(14deg);"></rect><circle r="26" cx="530.046875" cy="291" fill="none" stroke-width="10" stroke="red" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(-119px) translateY(27px) scale(0.21) rotate(-3deg);"></circle><circle r="26" cx="530.046875" cy="291" fill="none" stroke-width="10" stroke="#000" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(-129px) translateY(61px) scale(0.33) rotate(-4deg);"></circle><circle r="26" cx="530.046875" cy="291" fill="none" stroke-width="10" stroke="#fff" style="opacity: 0; transform-origin: 530.047px 291px; transform: translateX(115px) translateY(145px) scale(0.59) rotate(11deg);"></circle></svg><h2 class="word word--1" aria-label="thejoin"><span class="char1" aria-hidden="true" style="opacity: 0; transform: translateY(0px);">t</span><span class="char2" aria-hidden="true" style="opacity: 0; transform: translateY(0px);">h</span><span class="char3" aria-hidden="true" style="opacity: 0; transform: translateY(0px);">e</span><span class="char4" aria-hidden="true" style="opacity: 0; transform: translateY(0px);">j</span><span class="char5" aria-hidden="true" style="opacity: 0; transform: translateY(0px);">o</span><span class="char6" aria-hidden="true" style="opacity: 0; transform: translateY(0px);">i</span><span class="char7" aria-hidden="true" style="opacity: 0; transform: translateY(0px);">n</span></h2></div></div></div><section class="navigation relative"><div class="navigation-header fixed w-full"><div class="hidden md:block absolute say-hi tracking-wider"><a href="/" class="router-link-active"><img alt="Miki go to Home" src="/images/icon.png" class="mr-1 align-top inline-block w-6 m-w-full"></a><div class="hidden-tooltip inline-block"><span class="tooltip rounded shadow-lg p-1 bg-gray-600 text-grey-500 -mt-8"> Email address copied </span><a href="#">Say Hi.</a></div></div><div class="absolute hamburger cursor-pointer p-2 rounded-full"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="w-8"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg></div></div><div class="navigation-footer fixed w-full"><div class="hidden md:block absolute whoami tracking-wider"><a href="/whoami" class="">WhoAmI</a></div><div class="hidden md:block absolute writing tracking-wider"><a href="/blog" class="router-link-active">Writing</a></div></div><div class="hidden shadow md:shadow-2xl w-full md:w-1/3 h-full fixed off-canvas-menu z-10 p-5"><div class="close-header w-full border-opacity-50"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="inline w-12 cursor-pointer"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg><span class="text-4xl align-middle cursor-pointer">Close</span></div><div class="mb-5 md:mb-10 pb-3 md:pb-5 mobile-content absolute bottom-0 w-full text-3xl"><ul><li class="cursor-pointer pb-1"><a href="/" class="block router-link-active">~</a></li><li class="cursor-pointer py-1"><a href="/whoami" class="block">WhoAmI</a></li><li class="cursor-pointer py-1"><a href="/blog" class="block router-link-active">Writing</a></li><li class="cursor-pointer py-1 social-li"><span class="cursor-pointer">Social</span><ul class="social-box align-middle leading-none"><li class="inline-block pr-1"><a href="https://github.com/thejoin95" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve" class="github-icon w-6"><path fill="#FFFFFF" d="M10.015,9.949c0,0-0.01,0-0.015,0H9.985c-1.191,0-2.24-0.303-2.861,0.268  c-0.371,0.342-0.527,0.754-0.527,1.197c0,1.852,1.483,2.08,3.389,2.08h0.029c1.905,0,3.389-0.229,3.389-2.08  c0-0.443-0.156-0.856-0.527-1.197C12.255,9.646,11.206,9.949,10.015,9.949z M8.393,12.48c-0.363,0-0.656-0.408-0.656-0.91  s0.293-0.908,0.656-0.908S9.05,11.068,9.05,11.57C9.051,12.072,8.757,12.48,8.393,12.48z M11.606,12.48  c-0.363,0-0.657-0.408-0.657-0.91s0.294-0.908,0.657-0.908c0.362,0,0.656,0.406,0.656,0.908  C12.263,12.072,11.969,12.48,11.606,12.48z M10,0.4c-5.302,0-9.6,4.298-9.6,9.6s4.298,9.6,9.6,9.6s9.6-4.298,9.6-9.6  S15.302,0.4,10,0.4z M10.876,13.939c-0.172,0-0.514,0-0.876,0.002c-0.362-0.002-0.704-0.002-0.876-0.002  c-0.76,0-3.772-0.059-3.772-3.689c0-0.834,0.286-1.445,0.755-1.955c-0.074-0.184-0.078-1.232,0.32-2.236c0,0,0.916,0.1,2.301,1.051  C9.017,7.029,9.509,6.988,10,6.988s0.982,0.041,1.273,0.121c1.385-0.951,2.301-1.051,2.301-1.051  c0.398,1.004,0.395,2.053,0.32,2.236c0.469,0.51,0.755,1.121,0.755,1.955C14.648,13.881,11.636,13.939,10.876,13.939z"></path></svg></a></li><li class="inline-block px-1"><a href="https://www.facebook.com/mikistorm/" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve" class="fb-icon w-6"><path fill="#FFFFFF" d="M10,0.4c-5.302,0-9.6,4.298-9.6,9.6s4.298,9.6,9.6,9.6s9.6-4.298,9.6-9.6S15.302,0.4,10,0.4z M12.274,7.034  h-1.443c-0.171,0-0.361,0.225-0.361,0.524V8.6h1.805l-0.273,1.486H10.47v4.461H8.767v-4.461H7.222V8.6h1.545V7.726  c0-1.254,0.87-2.273,2.064-2.273h1.443V7.034z"></path></svg></a></li><li class="inline-block px-1"><a href="https://instagram.com/thejoin95" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve" class="ig-icon w-6"><path fill="#FFFFFF" d="M13.89777,7.05115a1.65591,1.65591,0,0,0-.94891-0.94891,2.76589,2.76589,0,0,0-.92841-0.17218C11.49316,5.906,11.33508,5.90094,10,5.90094S8.50684,5.906,7.97955,5.93005a2.76589,2.76589,0,0,0-.92841.17218,1.65591,1.65591,0,0,0-.94891.94891,2.76589,2.76589,0,0,0-.17218.92841C5.906,8.50684,5.90094,8.665,5.90094,10s0.00507,1.49316.02911,2.02045a2.76553,2.76553,0,0,0,.17218.92841,1.65591,1.65591,0,0,0,.94891.94891,2.76589,2.76589,0,0,0,.92841.17218c0.52716,0.024.6853,0.02911,2.02045,0.02911s1.49329-.00507,2.02045-0.02911a2.76589,2.76589,0,0,0,.92841-0.17218,1.65591,1.65591,0,0,0,.94891-0.94891,2.76553,2.76553,0,0,0,.17218-0.92841c0.024-.52728.02911-0.68536,0.02911-2.02045S14.094,8.50684,14.06995,7.97955A2.76589,2.76589,0,0,0,13.89777,7.05115ZM10,12.56757A2.56757,2.56757,0,1,1,12.56757,10,2.56756,2.56756,0,0,1,10,12.56757ZM12.669,7.931a0.6,0.6,0,1,1,.6-0.6A0.6,0.6,0,0,1,12.669,7.931ZM11.66669,10A1.66669,1.66669,0,1,1,10,8.33331,1.66671,1.66671,0,0,1,11.66669,10ZM10,0.4A9.6,9.6,0,1,0,19.6,10,9.59995,9.59995,0,0,0,10,.4Zm4.96991,11.6615a3.67039,3.67039,0,0,1-.23242,1.21368,2.55612,2.55612,0,0,1-1.46228,1.46228,3.67039,3.67039,0,0,1-1.21368.23242C11.5282,14.99426,11.35791,15,10,15s-1.5282-.00574-2.06152-0.03009a3.67039,3.67039,0,0,1-1.21368-.23242,2.55612,2.55612,0,0,1-1.46228-1.46228,3.67039,3.67039,0,0,1-.23242-1.21368C5.00574,11.5282,5,11.35791,5,10s0.00574-1.5282.03009-2.06152a3.67039,3.67039,0,0,1,.23242-1.21368A2.55612,2.55612,0,0,1,6.72479,5.26251a3.67039,3.67039,0,0,1,1.21368-.23242C8.4718,5.00574,8.64209,5,10,5s1.5282,0.00574,2.06152.03009a3.67039,3.67039,0,0,1,1.21368.23242,2.55612,2.55612,0,0,1,1.46228,1.46228,3.67039,3.67039,0,0,1,.23242,1.21368C14.99426,8.4718,15,8.64209,15,10S14.99426,11.5282,14.96991,12.06152Z"></path></svg></a></li><li class="inline-block px-1"><a href="https://www.linkedin.com/in/miki-lombardi/" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve" class="ld-icon w-6"><path fill="#FFFFFF" d="M10,0.4c-5.302,0-9.6,4.298-9.6,9.6s4.298,9.6,9.6,9.6s9.6-4.298,9.6-9.6S15.302,0.4,10,0.4z M7.65,13.979  H5.706V7.723H7.65V13.979z M6.666,6.955c-0.614,0-1.011-0.435-1.011-0.973c0-0.549,0.409-0.971,1.036-0.971s1.011,0.422,1.023,0.971  C7.714,6.52,7.318,6.955,6.666,6.955z M14.75,13.979h-1.944v-3.467c0-0.807-0.282-1.355-0.985-1.355  c-0.537,0-0.856,0.371-0.997,0.728c-0.052,0.127-0.065,0.307-0.065,0.486v3.607H8.814v-4.26c0-0.781-0.025-1.434-0.051-1.996h1.689  l0.089,0.869h0.039c0.256-0.408,0.883-1.01,1.932-1.01c1.279,0,2.238,0.857,2.238,2.699V13.979z"></path></svg></a></li><li class="inline-block px-1"><a href="https://medium.com/@thejoin95" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve" class="md-icon w-6"><path fill="#FFFFFF" d="M10,0.3999634c-5.3019409,0-9.5999756,4.2980957-9.5999756,9.6000366S4.6980591,19.5999756,10,19.5999756  S19.5999756,15.3019409,19.5999756,10S15.3019409,0.3999634,10,0.3999634z M14.2000122,7.666687h-0.1165771  c0,0-0.3500977,0-0.3500977,0.3500977c0,0.3500366,0,3.9666748,0,3.9666748s0,0.3497925,0.3500977,0.3497925h0.1165771v0.9333496  h-2.7999878V12.333252h0.4666138V7.9933472h-0.0466309l-1.4301147,5.2732544H9.1304321L7.7133179,7.9933472H7.666687v4.3399048  h0.4666748v0.9333496h-2.333374V12.333252h0.1165771c0,0,0.3500977,0,0.3500977-0.3500366s0-3.9667358,0-3.9667358  s0-0.3497925-0.3500977-0.3497925H5.7999878V6.7333984H8.895874l1.0858765,4.0408325h0.0357666l1.0959473-4.0408325h3.0865479  V7.666687z"></path></svg></a></li><li class="inline-block px-1"><a href="https://twitter.com/thejoin95" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve" class="tw-icon w-6"><path fill="#FFFFFF" d="M10,0.4c-5.302,0-9.6,4.298-9.6,9.6s4.298,9.6,9.6,9.6s9.6-4.298,9.6-9.6S15.302,0.4,10,0.4z M13.905,8.264  c0.004,0.082,0.005,0.164,0.005,0.244c0,2.5-1.901,5.381-5.379,5.381c-1.068,0-2.062-0.312-2.898-0.85  c0.147,0.018,0.298,0.025,0.451,0.025c0.886,0,1.701-0.301,2.348-0.809c-0.827-0.016-1.525-0.562-1.766-1.312  c0.115,0.021,0.233,0.033,0.355,0.033c0.172,0,0.34-0.023,0.498-0.066c-0.865-0.174-1.517-0.938-1.517-1.854V9.033  C6.257,9.174,6.549,9.26,6.859,9.27C6.351,8.93,6.018,8.352,6.018,7.695c0-0.346,0.093-0.672,0.256-0.951  c0.933,1.144,2.325,1.896,3.897,1.977c-0.033-0.139-0.049-0.283-0.049-0.432c0-1.043,0.846-1.891,1.891-1.891  c0.543,0,1.035,0.23,1.38,0.598c0.431-0.086,0.835-0.242,1.2-0.459c-0.141,0.441-0.44,0.812-0.831,1.047  c0.383-0.047,0.747-0.148,1.086-0.299C14.595,7.664,14.274,7.998,13.905,8.264z"></path></svg></a></li><li class="inline-block px-1"><a href="https://www.youtube.com/channel/UC1QLLgrGrPmlaFhS0orykCA" target="_blank"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve" class="yt-icon w-6"><path fill="#FFFFFF" d="M11.603,9.833L9.357,8.785C9.161,8.694,9,8.796,9,9.013v1.974c0,0.217,0.161,0.319,0.357,0.228l2.245-1.048  C11.799,10.075,11.799,9.925,11.603,9.833z M10,0.4c-5.302,0-9.6,4.298-9.6,9.6s4.298,9.6,9.6,9.6s9.6-4.298,9.6-9.6  S15.302,0.4,10,0.4z M10,13.9c-4.914,0-5-0.443-5-3.9s0.086-3.9,5-3.9s5,0.443,5,3.9S14.914,13.9,10,13.9z"></path></svg></a></li></ul></li><li class="cursor-pointer pt-1"><div class="hidden-tooltip"><span class="tooltip rounded shadow-lg p-1 bg-gray-600 text-grey-500 -mt-8"> Email address copied </span> Say Hi </div></li></ul></div></div></section><section class="article container mx-auto m-width-780 p-3 py-0"><article class="article-content p-3 prose md:prose-xl"> <h1 id="the-sorting-hat-experiment--webar-in-pure-js">The Sorting Hat Experiment | WebAR in pure JS</h1> <div class="mx-auto"> <img class="max-w-full" src="https://source.unsplash.com/Qqsgit1tyWw/960x680"> </div> <p>The power of <a href="https://arvrjourney.com/">augmented reality</a> in the palm of a hand: Google, with Chrome, is trying to develop and guarantee support for AR and VR by proposing a standard at the level of W3C. The proposals are still in draft and in the proposal phase, but there are already some experiments that can be tried.</p> <h2 id="how-to-implement-an-experience-in-ar">How to implement an experience in AR</h2> <p>There are many applications and experiments with AR technology, while there are few experiments with the same technology directly on the web.</p> <p>Despite the investments of many Big Companies on this technology, there is still no real standard for their realization.</p> <p>For the native, there are various libraries, tools and frameworks. Google has developed ARCore, which can be implemented on both iOS and Android, while Apple has developed ArKit which however can only be released on iOS.</p> <p>If we stop to reflect, the current lingua franca is javascript. The current environment, which everyone has, is the web. It is true, there is no guarantee of performance, due to the large scale of devices that have access to it.</p> <p>However, we can still achieve excellent results.</p> <h2 id="the-webgl-experiment">The WebGL experiment</h2> <p><img src="https://cdn-images-1.medium.com/max/2000/1*M3a3KWEdil5yJxxSkhxssA.png" alt=""></p> <p>About two years ago I implemented a small experiment in WebGL to extend the reality and, in fact, carry out an AR experiment: to implement the talking hat of the famous Harry Potter saga, to sort the various users in the various Hogwarts houses.</p> <p>You can see the full project by clicking on the <a href="https://github.com/TheJoin95/sorting-hat-experiment-webgl">Sorting Hat Experiment</a> repo link.</p> <p>The result can be visited <a href="https://experiments.thejoin.tech/">here</a> (self- signed certificate).</p> <h2 id="technologies-used-for-the-experiment">Technologies used for the experiment</h2> <p>The experiment was implemented in pure javascript, using the <a href="https://threejs.org/">Three.js</a> library , the native API to retrieve the camera and accelerometer input and making use of the <a href="https://trackingjs.com/">https://trackingjs.com/</a> library for facial recognition (via a MobileNet ).</p> <p>At the time of the experiment, there was still no google project to implement the WebXR API (API to implement the native web AR) in Chrome, nor the version of Three.js, oriented towards the management of a 3D environment in <a href="https://arvrjourney.com/">VR</a>, AR-oriented: <a href="https://github.com/google-ar/three.ar.js">Three.ar.js</a> .</p> <h2 id="how-the-experiment-was-implemented">How the experiment was implemented</h2> <p>The implementation was simple, as the only inputs are the camera of the device (pc or smartphone) and the input of the questionnaire taken from the Pottermore site (a reference site for the Harry Potter saga).</p> <p>The critical issues are related to the support of a wide range of devices. The experiment, not using libraries optimized for <a href="https://arvrjourney.com/">AR</a>, suffers from *fps lag, *on older devices with CPU and GPU not of medium / high range.</p> <p><img src="https://cdn-images-1.medium.com/max/2000/1*ThaRgxpoSZyj58F-f20Iww.png" alt="Example of face recognition in web app"><em>Example of face recognition in web app</em></p> <p>The greatest optimization, to try to solve this problem, was done in rendering the 3D model of the sorting hat based on facial recognition.</p> <p>This process brings a big charge at the CPU and GPU level, since on each tick he has to update the whole canvas (our AR level) and reposition the hat.</p> <p>The main optimization was to carry out the facial reconnaissance process only every tot of frames per second, in this way it is possible to guarantee a smooth experience without weighing down the less performing device, effectively levelling all the other higher-end devices. .</p> <p>At the start of the quiz, audio files were loaded and played in sequence, based on the choices of the questionnaire, which replicated the scenes of the film and the indecision of the hat.</p> <p>At the end of the quiz, the sorting hat decreed the house of belonging and exclaimed its name.</p> <h2 id="conclusion">Conclusion</h2> <p>An experiment of this kind, brought to a more professional level, with the right tools and with more resources, could certainly be useful to JK Rowling in the boom of the saga to further retain the various users.</p> </article></section></div><script src="/js/chunk-vendors.f00deeb5.js"></script><script src="/js/app.c1e52978.js"></script></body></html>